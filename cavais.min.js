// cavais.min.js - v2.0
(function(window, document) {
    'use strict';
    
    // Cavais Core
    const Cavais = {
        version: '2.0.0',
        config: {
            breakpoints: {
                sm: '640px',
                md: '768px',
                lg: '1024px',
                xl: '1280px',
                '2xl': '1536px'
            },
            colors: {
                primary: {
                    50: '#eff6ff',
                    100: '#dbeafe',
                    200: '#bfdbfe',
                    300: '#93c5fd',
                    400: '#60a5fa',
                    500: '#3b82f6',
                    600: '#2563eb',
                    700: '#1d4ed8',
                    800: '#1e40af',
                    900: '#1e3a8a'
                },
                secondary: {
                    50: '#fdf4ff',
                    100: '#fae8ff',
                    200: '#f5d0fe',
                    300: '#f0abfc',
                    400: '#e879f9',
                    500: '#d946ef',
                    600: '#c026d3',
                    700: '#a21caf',
                    800: '#86198f',
                    900: '#701a75'
                },
                success: {
                    50: '#f0fdf4',
                    100: '#dcfce7',
                    200: '#bbf7d0',
                    300: '#86efac',
                    400: '#4ade80',
                    500: '#22c55e',
                    600: '#16a34a',
                    700: '#15803d',
                    800: '#166534',
                    900: '#14532d'
                },
                warning: {
                    50: '#fffbeb',
                    100: '#fef3c7',
                    200: '#fde68a',
                    300: '#fcd34d',
                    400: '#fbbf24',
                    500: '#f59e0b',
                    600: '#d97706',
                    700: '#b45309',
                    800: '#92400e',
                    900: '#78350f'
                },
                danger: {
                    50: '#fef2f2',
                    100: '#fee2e2',
                    200: '#fecaca',
                    300: '#fca5a5',
                    400: '#f87171',
                    500: '#ef4444',
                    600: '#dc2626',
                    700: '#b91c1c',
                    800: '#991b1b',
                    900: '#7f1d1d'
                },
                gray: {
                    50: '#f9fafb',
                    100: '#f3f4f6',
                    200: '#e5e7eb',
                    300: '#d1d5db',
                    400: '#9ca3af',
                    500: '#6b7280',
                    600: '#4b5563',
                    700: '#374151',
                    800: '#1f2937',
                    900: '#111827'
                }
            },
            spacing: {
                0: '0',
                1: '0.25rem',
                2: '0.5rem',
                3: '0.75rem',
                4: '1rem',
                5: '1.25rem',
                6: '1.5rem',
                8: '2rem',
                10: '2.5rem',
                12: '3rem',
                16: '4rem',
                20: '5rem',
                24: '6rem',
                32: '8rem',
                40: '10rem',
                48: '12rem',
                56: '14rem',
                64: '16rem'
            },
            fontSizes: {
                xs: '0.75rem',
                sm: '0.875rem',
                base: '1rem',
                lg: '1.125rem',
                xl: '1.25rem',
                '2xl': '1.5rem',
                '3xl': '1.875rem',
                '4xl': '2.25rem',
                '5xl': '3rem',
                '6xl': '3.75rem'
            }
        },
        
        // 시스템 상태
        observers: [],
        components: {},
        
        // 초기화
        init: function(options = {}) {
            // 설정 병합
            this.config = this.deepMerge(this.config, options);
            
            // 스타일 주입
            this.injectBaseStyles();
            
            // 컴포넌트 초기화
            this.initComponents();
            
            // 반응형 옵저버 설정
            this.setupResponsiveObserver();
            
            // 이벤트 리스너
            this.setupEventListeners();
            
            console.log(`Cavais v${this.version} initialized`);
            return this;
        },
        
        // 깊은 병합 유틸리티
        deepMerge: function(target, source) {
            for (const key in source) {
                if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {
                    if (!target[key] || typeof target[key] !== 'object') {
                        target[key] = {};
                    }
                    this.deepMerge(target[key], source[key]);
                } else {
                    target[key] = source[key];
                }
            }
            return target;
        },
        
        // 기본 스타일 주입
        injectBaseStyles: function() {
            if (document.querySelector('#cavais-base-styles')) return;
            
            const style = document.createElement('style');
            style.id = 'cavais-base-styles';
            style.textContent = this.generateBaseCSS();
            document.head.appendChild(style);
        },
        
        // 기본 CSS 생성
        generateBaseCSS: function() {
            let css = ':root {';
            
            // CSS 변수 생성
            // 색상 변수
            for (const [colorName, shades] of Object.entries(this.config.colors)) {
                for (const [shade, value] of Object.entries(shades)) {
                    css += `--cavais-${colorName}-${shade}: ${value};`;
                }
            }
            
            // 간격 변수
            for (const [size, value] of Object.entries(this.config.spacing)) {
                css += `--cavais-spacing-${size}: ${value};`;
            }
            
            // 폰트 크기 변수
            for (const [size, value] of Object.entries(this.config.fontSizes)) {
                css += `--cavais-font-${size}: ${value};`;
            }
            
            css += '}';
            
            // 유틸리티 클래스
            css += `
                /* 컨테이너 */
                .c-container {
                    width: 100%;
                    margin-right: auto;
                    margin-left: auto;
                    padding-right: 1rem;
                    padding-left: 1rem;
                }
                
                @media (min-width: 640px) {
                    .c-container { max-width: 640px; }
                }
                
                @media (min-width: 768px) {
                    .c-container { max-width: 768px; }
                }
                
                @media (min-width: 1024px) {
                    .c-container { max-width: 1024px; }
                }
                
                @media (min-width: 1280px) {
                    .c-container { max-width: 1280px; }
                }
                
                @media (min-width: 1536px) {
                    .c-container { max-width: 1536px; }
                }
                
                /* 플렉스 유틸리티 */
                .c-flex { display: flex; }
                .c-inline-flex { display: inline-flex; }
                .c-flex-row { flex-direction: row; }
                .c-flex-col { flex-direction: column; }
                .c-flex-wrap { flex-wrap: wrap; }
                .c-flex-nowrap { flex-wrap: nowrap; }
                .c-items-start { align-items: flex-start; }
                .c-items-end { align-items: flex-end; }
                .c-items-center { align-items: center; }
                .c-items-baseline { align-items: baseline; }
                .c-items-stretch { align-items: stretch; }
                .c-justify-start { justify-content: flex-start; }
                .c-justify-end { justify-content: flex-end; }
                .c-justify-center { justify-content: center; }
                .c-justify-between { justify-content: space-between; }
                .c-justify-around { justify-content: space-around; }
                .c-justify-evenly { justify-content: space-evenly; }
                
                /* 그리드 유틸리티 */
                .c-grid { display: grid; }
                .c-grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
                .c-grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
                .c-grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
                .c-grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
                .c-grid-cols-5 { grid-template-columns: repeat(5, minmax(0, 1fr)); }
                .c-grid-cols-6 { grid-template-columns: repeat(6, minmax(0, 1fr)); }
                .c-grid-cols-12 { grid-template-columns: repeat(12, minmax(0, 1fr)); }
                
                /* 간격 유틸리티 */
                .c-gap-0 { gap: 0; }
                .c-gap-1 { gap: var(--cavais-spacing-1); }
                .c-gap-2 { gap: var(--cavais-spacing-2); }
                .c-gap-3 { gap: var(--cavais-spacing-3); }
                .c-gap-4 { gap: var(--cavais-spacing-4); }
                .c-gap-5 { gap: var(--cavais-spacing-5); }
                .c-gap-6 { gap: var(--cavais-spacing-6); }
                .c-gap-8 { gap: var(--cavais-spacing-8); }
                
                /* 패딩 유틸리티 */
                .c-p-0 { padding: 0; }
                .c-p-1 { padding: var(--cavais-spacing-1); }
                .c-p-2 { padding: var(--cavais-spacing-2); }
                .c-p-3 { padding: var(--cavais-spacing-3); }
                .c-p-4 { padding: var(--cavais-spacing-4); }
                .c-p-5 { padding: var(--cavais-spacing-5); }
                .c-p-6 { padding: var(--cavais-spacing-6); }
                .c-p-8 { padding: var(--cavais-spacing-8); }
                
                /* 마진 유틸리티 */
                .c-m-0 { margin: 0; }
                .c-m-1 { margin: var(--cavais-spacing-1); }
                .c-m-2 { margin: var(--cavais-spacing-2); }
                .c-m-3 { margin: var(--cavais-spacing-3); }
                .c-m-4 { margin: var(--cavais-spacing-4); }
                .c-m-5 { margin: var(--cavais-spacing-5); }
                .c-m-6 { margin: var(--cavais-spacing-6); }
                .c-m-8 { margin: var(--cavais-spacing-8); }
                
                /* 텍스트 유틸리티 */
                .c-text-xs { font-size: var(--cavais-font-xs); }
                .c-text-sm { font-size: var(--cavais-font-sm); }
                .c-text-base { font-size: var(--cavais-font-base); }
                .c-text-lg { font-size: var(--cavais-font-lg); }
                .c-text-xl { font-size: var(--cavais-font-xl); }
                .c-text-2xl { font-size: var(--cavais-font-2xl); }
                .c-text-3xl { font-size: var(--cavais-font-3xl); }
                .c-text-4xl { font-size: var(--cavais-font-4xl); }
                .c-text-5xl { font-size: var(--cavais-font-5xl); }
                .c-text-6xl { font-size: var(--cavais-font-6xl); }
                
                .c-font-thin { font-weight: 100; }
                .c-font-light { font-weight: 300; }
                .c-font-normal { font-weight: 400; }
                .c-font-medium { font-weight: 500; }
                .c-font-semibold { font-weight: 600; }
                .c-font-bold { font-weight: 700; }
                .c-font-extrabold { font-weight: 800; }
                
                .c-text-left { text-align: left; }
                .c-text-center { text-align: center; }
                .c-text-right { text-align: right; }
                .c-text-justify { text-align: justify; }
                
                /* 색상 유틸리티 */
                .c-bg-primary-500 { background-color: var(--cavais-primary-500); }
                .c-bg-secondary-500 { background-color: var(--cavais-secondary-500); }
                .c-bg-success-500 { background-color: var(--cavais-success-500); }
                .c-bg-warning-500 { background-color: var(--cavais-warning-500); }
                .c-bg-danger-500 { background-color: var(--cavais-danger-500); }
                .c-bg-gray-100 { background-color: var(--cavais-gray-100); }
                .c-bg-white { background-color: white; }
                .c-bg-transparent { background-color: transparent; }
                
                .c-text-primary-500 { color: var(--cavais-primary-500); }
                .c-text-secondary-500 { color: var(--cavais-secondary-500); }
                .c-text-success-500 { color: var(--cavais-success-500); }
                .c-text-warning-500 { color: var(--cavais-warning-500); }
                .c-text-danger-500 { color: var(--cavais-danger-500); }
                .c-text-gray-700 { color: var(--cavais-gray-700); }
                .c-text-white { color: white; }
                .c-text-black { color: black; }
                
                /* 반응형 디스플레이 */
                .c-block { display: block; }
                .c-inline-block { display: inline-block; }
                .c-inline { display: inline; }
                .c-hidden { display: none; }
                
                /* 반응형 유틸리티 (모바일 기본) */
                .c-sm\\:hidden { display: block; }
                .c-md\\:hidden { display: block; }
                .c-lg\\:hidden { display: block; }
                .c-xl\\:hidden { display: block; }
                
                @media (min-width: 640px) {
                    .c-sm\\:block { display: block !important; }
                    .c-sm\\:hidden { display: none !important; }
                    .c-sm\\:flex { display: flex !important; }
                    .c-sm\\:grid { display: grid !important; }
                    .c-sm\\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)) !important; }
                    .c-sm\\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)) !important; }
                    .c-sm\\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)) !important; }
                }
                
                @media (min-width: 768px) {
                    .c-md\\:block { display: block !important; }
                    .c-md\\:hidden { display: none !important; }
                    .c-md\\:flex { display: flex !important; }
                    .c-md\\:grid { display: grid !important; }
                    .c-md\\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)) !important; }
                    .c-md\\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)) !important; }
                    .c-md\\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)) !important; }
                    .c-md\\:grid-cols-6 { grid-template-columns: repeat(6, minmax(0, 1fr)) !important; }
                }
                
                @media (min-width: 1024px) {
                    .c-lg\\:block { display: block !important; }
                    .c-lg\\:hidden { display: none !important; }
                    .c-lg\\:flex { display: flex !important; }
                    .c-lg\\:grid { display: grid !important; }
                    .c-lg\\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)) !important; }
                    .c-lg\\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)) !important; }
                    .c-lg\\:grid-cols-6 { grid-template-columns: repeat(6, minmax(0, 1fr)) !important; }
                    .c-lg\\:grid-cols-12 { grid-template-columns: repeat(12, minmax(0, 1fr)) !important; }
                }
                
                @media (min-width: 1280px) {
                    .c-xl\\:block { display: block !important; }
                    .c-xl\\:hidden { display: none !important; }
                    .c-xl\\:flex { display: flex !important; }
                    .c-xl\\:grid { display: grid !important; }
                    .c-xl\\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)) !important; }
                    .c-xl\\:grid-cols-6 { grid-template-columns: repeat(6, minmax(0, 1fr)) !important; }
                    .c-xl\\:grid-cols-12 { grid-template-columns: repeat(12, minmax(0, 1fr)) !important; }
                }
                
                /* 컴포넌트 스타일 */
                .c-btn {
                    display: inline-flex;
                    align-items: center;
                    justify-content: center;
                    padding: 0.5rem 1rem;
                    border-radius: 0.375rem;
                    border: 1px solid transparent;
                    font-weight: 500;
                    font-size: 0.875rem;
                    line-height: 1.25rem;
                    cursor: pointer;
                    transition: all 150ms cubic-bezier(0.4, 0, 0.2, 1);
                    user-select: none;
                    text-decoration: none;
                }
                
                .c-btn:hover {
                    transform: translateY(-1px);
                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
                }
                
                .c-btn:active {
                    transform: translateY(0);
                }
                
                .c-btn-primary {
                    background-color: var(--cavais-primary-600);
                    color: white;
                }
                
                .c-btn-primary:hover {
                    background-color: var(--cavais-primary-700);
                }
                
                .c-btn-secondary {
                    background-color: var(--cavais-secondary-600);
                    color: white;
                }
                
                .c-btn-outline {
                    background-color: transparent;
                    border-color: var(--cavais-gray-300);
                    color: var(--cavais-gray-700);
                }
                
                .c-btn-outline:hover {
                    background-color: var(--cavais-gray-50);
                }
                
                .c-card {
                    background-color: white;
                    border-radius: 0.5rem;
                    border: 1px solid var(--cavais-gray-200);
                    overflow: hidden;
                    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
                    transition: box-shadow 150ms cubic-bezier(0.4, 0, 0.2, 1);
                }
                
                .c-card:hover {
                    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.12);
                }
                
                .c-card-header {
                    padding: 1.5rem 1.5rem 0;
                }
                
                .c-card-body {
                    padding: 1.5rem;
                }
                
                .c-card-footer {
                    padding: 0 1.5rem 1.5rem;
                }
                
                .c-form-input {
                    display: block;
                    width: 100%;
                    padding: 0.5rem 0.75rem;
                    border: 1px solid var(--cavais-gray-300);
                    border-radius: 0.375rem;
                    font-size: 0.875rem;
                    line-height: 1.25rem;
                    transition: border-color 150ms cubic-bezier(0.4, 0, 0.2, 1);
                }
                
                .c-form-input:focus {
                    outline: none;
                    border-color: var(--cavais-primary-500);
                    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
                }
                
                .c-form-label {
                    display: block;
                    font-size: 0.875rem;
                    font-weight: 500;
                    color: var(--cavais-gray-700);
                    margin-bottom: 0.25rem;
                }
                
                /* 애니메이션 */
                .c-transition {
                    transition-property: all;
                    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                    transition-duration: 150ms;
                }
                
                .c-transition-colors {
                    transition-property: background-color, border-color, color;
                    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                    transition-duration: 150ms;
                }
                
                .c-duration-150 { transition-duration: 150ms; }
                .c-duration-300 { transition-duration: 300ms; }
                .c-duration-500 { transition-duration: 500ms; }
            `;
            
            return css;
        },
        
        // 컴포넌트 초기화
        initComponents: function() {
            this.components = {
                alerts: new Set(),
                modals: new Set(),
                dropdowns: new Set()
            };
        },
        
        // 반응형 옵저버 설정
        setupResponsiveObserver: function() {
            const breakpoints = this.config.breakpoints;
            
            // 현재 브레이크포인트 감지
            this.getCurrentBreakpoint = function() {
                const width = window.innerWidth;
                
                if (width >= parseInt(breakpoints['2xl'])) return '2xl';
                if (width >= parseInt(breakpoints.xl)) return 'xl';
                if (width >= parseInt(breakpoints.lg)) return 'lg';
                if (width >= parseInt(breakpoints.md)) return 'md';
                if (width >= parseInt(breakpoints.sm)) return 'sm';
                return 'xs';
            };
            
            // 현재 브레이크포인트 상태 저장
            this.currentBreakpoint = this.getCurrentBreakpoint();
            
            // 리사이즈 이벤트
            let resizeTimer;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimer);
                resizeTimer = setTimeout(() => {
                    const newBreakpoint = this.getCurrentBreakpoint();
                    if (newBreakpoint !== this.currentBreakpoint) {
                        this.currentBreakpoint = newBreakpoint;
                        this.dispatchEvent('breakpointchange', { breakpoint: newBreakpoint });
                    }
                }, 100);
            });
        },
        
        // 이벤트 리스너 설정
        setupEventListeners: function() {
            // 버튼 ripple 효과
            document.addEventListener('click', (e) => {
                const btn = e.target.closest('.c-btn');
                if (btn && !btn.classList.contains('c-btn-no-ripple')) {
                    this.createRippleEffect(e, btn);
                }
            });
            
            // 폼 유효성 검사
            document.addEventListener('blur', (e) => {
                if (e.target.classList.contains('c-form-input')) {
                    this.validateFormInput(e.target);
                }
            }, true);
        },
        
        // ripple 효과 생성
        createRippleEffect: function(event, element) {
            const circle = document.createElement('span');
            const diameter = Math.max(element.clientWidth, element.clientHeight);
            const radius = diameter / 2;
            
            circle.style.width = circle.style.height = `${diameter}px`;
            circle.style.left = `${event.clientX - element.getBoundingClientRect().left - radius}px`;
            circle.style.top = `${event.clientY - element.getBoundingClientRect().top - radius}px`;
            circle.classList.add('c-ripple');
            
            const ripple = element.getElementsByClassName('c-ripple')[0];
            if (ripple) ripple.remove();
            
            element.appendChild(circle);
            
            setTimeout(() => circle.remove(), 600);
        },
        
        // 폼 입력 검증
        validateFormInput: function(input) {
            if (input.hasAttribute('required') && !input.value.trim()) {
                input.classList.add('c-invalid');
                this.showInputError(input, 'This field is required');
            } else if (input.type === 'email' && input.value) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(input.value)) {
                    input.classList.add('c-invalid');
                    this.showInputError(input, 'Please enter a valid email address');
                } else {
                    input.classList.remove('c-invalid');
                    this.removeInputError(input);
                }
            } else {
                input.classList.remove('c-invalid');
                this.removeInputError(input);
            }
        },
        
        showInputError: function(input, message) {
            let errorElement = input.nextElementSibling;
            if (!errorElement || !errorElement.classList.contains('c-input-error')) {
                errorElement = document.createElement('div');
                errorElement.className = 'c-input-error c-text-sm c-text-danger-500 c-mt-1';
                input.parentNode.insertBefore(errorElement, input.nextSibling);
            }
            errorElement.textContent = message;
        },
        
        removeInputError: function(input) {
            const errorElement = input.nextElementSibling;
            if (errorElement && errorElement.classList.contains('c-input-error')) {
                errorElement.remove();
            }
        },
        
        // 디자인 새로고침 기능
        refresh: function(newConfig = {}) {
            console.log('Refreshing Cavais design system...');
            
            // 새 설정 적용
            this.config = this.deepMerge(this.config, newConfig);
            
            // 기존 스타일 제거
            const oldStyle = document.getElementById('cavais-base-styles');
            if (oldStyle) oldStyle.remove();
            
            // 새 스타일 주입
            this.injectBaseStyles();
            
            // 컴포넌트 재초기화
            this.initComponents();
            
            // 이벤트 발송
            this.dispatchEvent('refresh', { config: this.config });
            
            console.log('Cavais design system refreshed successfully');
            return this;
        },
        
        // 커스텀 알림 시스템
        Alert: {
            show: function(options = {}) {
                const config = {
                    message: 'Alert message',
                    type: 'info', // info, success, warning, error
                    style: 'default', // default, dynamic-island, left, right, floating
                    duration: 5000,
                    position: 'top-right', // top-right, top-left, bottom-right, bottom-left, top-center, bottom-center
                    icon: true,
                    closeable: true,
                    ...options
                };
                
                const alert = this.createAlertElement(config);
                document.body.appendChild(alert);
                
                // 애니메이션
                setTimeout(() => alert.classList.add('c-alert-show'), 10);
                
                // 자동 제거
                if (config.duration > 0) {
                    setTimeout(() => this.close(alert), config.duration);
                }
                
                // 닫기 버튼
                if (config.closeable) {
                    const closeBtn = alert.querySelector('.c-alert-close');
                    if (closeBtn) {
                        closeBtn.addEventListener('click', () => this.close(alert));
                    }
                }
                
                return alert;
            },
            
            createAlertElement: function(config) {
                const alert = document.createElement('div');
                alert.className = `c-alert c-alert-${config.style} c-alert-${config.type} c-alert-${config.position}`;
                
                let icon = '';
                if (config.icon) {
                    const icons = {
                        info: 'ℹ️',
                        success: '✅',
                        warning: '⚠️',
                        error: '❌'
                    };
                    icon = `<span class="c-alert-icon">${icons[config.type] || icons.info}</span>`;
                }
                
                let closeBtn = '';
                if (config.closeable) {
                    closeBtn = '<button class="c-alert-close">×</button>';
                }
                
                alert.innerHTML = `
                    <div class="c-alert-content">
                        ${icon}
                        <span class="c-alert-message">${config.message}</span>
                    </div>
                    ${closeBtn}
                `;
                
                return alert;
            },
            
            close: function(alertElement) {
                alertElement.classList.remove('c-alert-show');
                alertElement.classList.add('c-alert-hide');
                setTimeout(() => {
                    if (alertElement.parentNode) {
                        alertElement.parentNode.removeChild(alertElement);
                    }
                }, 300);
            }
        },
        
        // 토스트 알림
        toast: function(message, type = 'info', duration = 3000) {
            return this.Alert.show({
                message,
                type,
                style: 'floating',
                position: 'bottom-center',
                duration,
                icon: true,
                closeable: true
            });
        },
        
        // 모달 시스템
        Modal: {
            show: function(options = {}) {
                const config = {
                    title: 'Modal Title',
                    content: 'Modal content goes here',
                    size: 'md', // sm, md, lg, xl
                    closeOnBackdrop: true,
                    showCloseButton: true,
                    ...options
                };
                
                const modal = this.createModal(config);
                document.body.appendChild(modal);
                document.body.style.overflow = 'hidden';
                
                // 애니메이션
                setTimeout(() => modal.classList.add('c-modal-show'), 10);
                
                return modal;
            },
            
            createModal: function(config) {
                const modal = document.createElement('div');
                modal.className = `c-modal c-modal-${config.size}`;
                
                let closeButton = '';
                if (config.showCloseButton) {
                    closeButton = '<button class="c-modal-close">×</button>';
                }
                
                modal.innerHTML = `
                    <div class="c-modal-backdrop"></div>
                    <div class="c-modal-container">
                        <div class="c-modal-content">
                            <div class="c-modal-header">
                                <h3 class="c-modal-title">${config.title}</h3>
                                ${closeButton}
                            </div>
                            <div class="c-modal-body">
                                ${config.content}
                            </div>
                        </div>
                    </div>
                `;
                
                // 닫기 이벤트
                const backdrop = modal.querySelector('.c-modal-backdrop');
                const closeBtn = modal.querySelector('.c-modal-close');
                
                if (config.closeOnBackdrop && backdrop) {
                    backdrop.addEventListener('click', () => this.close(modal));
                }
                
                if (closeBtn) {
                    closeBtn.addEventListener('click', () => this.close(modal));
                }
                
                return modal;
            },
            
            close: function(modalElement) {
                modalElement.classList.remove('c-modal-show');
                modalElement.classList.add('c-modal-hide');
                setTimeout(() => {
                    if (modalElement.parentNode) {
                        modalElement.parentNode.removeChild(modalElement);
                        document.body.style.overflow = '';
                    }
                }, 300);
            }
        },
        
        // 드롭다운 시스템
        Dropdown: {
            init: function(triggerElement, contentElement) {
                triggerElement.classList.add('c-dropdown-trigger');
                contentElement.classList.add('c-dropdown-content', 'c-hidden');
                
                triggerElement.addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.toggle(contentElement);
                });
                
                document.addEventListener('click', () => {
                    this.hide(contentElement);
                });
                
                contentElement.addEventListener('click', (e) => {
                    e.stopPropagation();
                });
            },
            
            toggle: function(contentElement) {
                contentElement.classList.toggle('c-hidden');
            },
            
            hide: function(contentElement) {
                contentElement.classList.add('c-hidden');
            },
            
            show: function(contentElement) {
                contentElement.classList.remove('c-hidden');
            }
        },
        
        // 이벤트 시스템
        on: function(event, callback) {
            if (!this.observers[event]) this.observers[event] = [];
            this.observers[event].push(callback);
        },
        
        off: function(event, callback) {
            if (!this.observers[event]) return;
            const index = this.observers[event].indexOf(callback);
            if (index > -1) this.observers[event].splice(index, 1);
        },
        
        dispatchEvent: function(event, data) {
            if (!this.observers[event]) return;
            this.observers[event].forEach(callback => callback(data));
        },
        
        // 반응형 헬퍼 함수
        isMobile: function() {
            return this.currentBreakpoint === 'xs' || this.currentBreakpoint === 'sm';
        },
        
        isTablet: function() {
            return this.currentBreakpoint === 'md';
        },
        
        isDesktop: function() {
            return this.currentBreakpoint === 'lg' || this.currentBreakpoint === 'xl' || this.currentBreakpoint === '2xl';
        },
        
        // 유틸리티 함수
        uuid: function() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                const r = Math.random() * 16 | 0;
                const v = c === 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        },
        
        debounce: function(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        },
        
        throttle: function(func, limit) {
            let inThrottle;
            return function() {
                const args = arguments;
                const context = this;
                if (!inThrottle) {
                    func.apply(context, args);
                    inThrottle = true;
                    setTimeout(() => inThrottle = false, limit);
                }
            };
        }
    };
    
    // 전역 객체로 설정
    window.Cavais = Cavais;
    
    // DOM 로드 시 자동 초기화
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => Cavais.init());
    } else {
        Cavais.init();
    }
    
    // 반응형 CSS 추가
    const responsiveCSS = `
        /* 반응형 알림 스타일 */
        .c-alert {
            position: fixed;
            z-index: 9999;
            max-width: 90%;
            opacity: 0;
            transform: translateY(-20px);
            transition: opacity 0.3s, transform 0.3s;
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .c-alert-show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .c-alert-hide {
            opacity: 0;
            transform: translateY(-20px);
        }
        
        .c-alert-top-right {
            top: 1rem;
            right: 1rem;
        }
        
        .c-alert-top-left {
            top: 1rem;
            left: 1rem;
        }
        
        .c-alert-bottom-right {
            bottom: 1rem;
            right: 1rem;
        }
        
        .c-alert-bottom-left {
            bottom: 1rem;
            left: 1rem;
        }
        
        .c-alert-top-center {
            top: 1rem;
            left: 50%;
            transform: translateX(-50%) translateY(-20px);
        }
        
        .c-alert-top-center.c-alert-show {
            transform: translateX(-50%) translateY(0);
        }
        
        .c-alert-bottom-center {
            bottom: 1rem;
            left: 50%;
            transform: translateX(-50%) translateY(20px);
        }
        
        .c-alert-bottom-center.c-alert-show {
            transform: translateX(-50%) translateY(0);
        }
        
        /* 알림 타입 */
        .c-alert-info {
            background-color: var(--cavais-primary-50);
            border: 1px solid var(--cavais-primary-200);
            color: var(--cavais-primary-800);
        }
        
        .c-alert-success {
            background-color: var(--cavais-success-50);
            border: 1px solid var(--cavais-success-200);
            color: var(--cavais-success-800);
        }
        
        .c-alert-warning {
            background-color: var(--cavais-warning-50);
            border: 1px solid var(--cavais-warning-200);
            color: var(--cavais-warning-800);
        }
        
        .c-alert-error {
            background-color: var(--cavais-danger-50);
            border: 1px solid var(--cavais-danger-200);
            color: var(--cavais-danger-800);
        }
        
        /* 알림 스타일 */
        .c-alert-default {
            min-width: 300px;
        }
        
        .c-alert-dynamic-island {
            border-radius: 9999px;
            padding: 0.75rem 1.5rem;
            font-weight: 500;
        }
        
        .c-alert-left {
            border-left: 4px solid;
        }
        
        .c-alert-right {
            border-right: 4px solid;
        }
        
        .c-alert-floating {
            border-radius: 0.75rem;
            padding: 1rem 1.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .c-alert-content {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .c-alert-icon {
            font-size: 1.25rem;
        }
        
        .c-alert-message {
            flex: 1;
        }
        
        .c-alert-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            line-height: 1;
            cursor: pointer;
            opacity: 0.7;
            margin-left: 0.75rem;
            padding: 0;
            width: 1.5rem;
            height: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .c-alert-close:hover {
            opacity: 1;
        }
        
        /* 모달 스타일 */
        .c-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 99999;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        
        .c-modal-show {
            opacity: 1;
            visibility: visible;
        }
        
        .c-modal-hide {
            opacity: 0;
            visibility: hidden;
        }
        
        .c-modal-backdrop {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }
        
        .c-modal-container {
            position: relative;
            z-index: 1;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.95);
            transition: transform 0.3s;
        }
        
        .c-modal-show .c-modal-container {
            transform: scale(1);
        }
        
        .c-modal-content {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            overflow: hidden;
        }
        
        .c-modal-sm .c-modal-container {
            max-width: 400px;
        }
        
        .c-modal-md .c-modal-container {
            max-width: 600px;
        }
        
        .c-modal-lg .c-modal-container {
            max-width: 800px;
        }
        
        .c-modal-xl .c-modal-container {
            max-width: 1140px;
        }
        
        .c-modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--cavais-gray-200);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .c-modal-title {
            margin: 0;
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--cavais-gray-900);
        }
        
        .c-modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            line-height: 1;
            cursor: pointer;
            opacity: 0.7;
            padding: 0;
            width: 2rem;
            height: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.375rem;
        }
        
        .c-modal-close:hover {
            opacity: 1;
            background-color: var(--cavais-gray-100);
        }
        
        .c-modal-body {
            padding: 1.5rem;
        }
        
        /* 드롭다운 스타일 */
        .c-dropdown-content {
            position: absolute;
            background-color: white;
            border: 1px solid var(--cavais-gray-200);
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            z-index: 50;
            min-width: 200px;
            margin-top: 0.5rem;
        }
        
        /* ripple 효과 스타일 */
        .c-ripple {
            position: absolute;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.7);
            transform: scale(0);
            animation: c-ripple-animation 0.6s linear;
            pointer-events: none;
        }
        
        @keyframes c-ripple-animation {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }
        
        /* 반응형 테이블 */
        .c-table-responsive {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .c-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .c-table th,
        .c-table td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid var(--cavais-gray-200);
            text-align: left;
        }
        
        .c-table th {
            font-weight: 600;
            background-color: var(--cavais-gray-50);
        }
        
        .c-table tbody tr:hover {
            background-color: var(--cavais-gray-50);
        }
        
        /* 반응형 이미지 */
        .c-img-responsive {
            max-width: 100%;
            height: auto;
        }
        
        /* 모바일 터치 개선 */
        @media (max-width: 768px) {
            .c-modal-container {
                width: 95%;
                margin: 0.5rem;
            }
            
            .c-modal-sm .c-modal-container,
            .c-modal-md .c-modal-container,
            .c-modal-lg .c-modal-container,
            .c-modal-xl .c-modal-container {
                max-width: none;
            }
            
            .c-alert {
                max-width: calc(100% - 2rem);
            }
            
            .c-alert-default {
                min-width: auto;
            }
            
            /* 모바일 터치 버튼 */
            .c-btn {
                min-height: 44px;
                min-width: 44px;
            }
        }
        
        /* 태블릿 최적화 */
        @media (min-width: 768px) and (max-width: 1024px) {
            .c-modal-container {
                width: 80%;
            }
        }
        
        /* 다크 모드 지원 */
        @media (prefers-color-scheme: dark) {
            .c-card {
                background-color: var(--cavais-gray-800);
                border-color: var(--cavais-gray-700);
                color: var(--cavais-gray-100);
            }
            
            .c-form-input {
                background-color: var(--cavais-gray-800);
                border-color: var(--cavais-gray-600);
                color: var(--cavais-gray-100);
            }
            
            .c-form-input:focus {
                border-color: var(--cavais-primary-500);
            }
            
            .c-modal-content {
                background-color: var(--cavais-gray-800);
                color: var(--cavais-gray-100);
            }
            
            .c-modal-header {
                border-bottom-color: var(--cavais-gray-700);
            }
            
            .c-modal-title {
                color: var(--cavais-gray-100);
            }
            
            .c-modal-close:hover {
                background-color: var(--cavais-gray-700);
            }
            
            .c-dropdown-content {
                background-color: var(--cavais-gray-800);
                border-color: var(--cavais-gray-700);
            }
            
            .c-table th {
                background-color: var(--cavais-gray-700);
                color: var(--cavais-gray-100);
            }
            
            .c-table td {
                border-bottom-color: var(--cavais-gray-700);
                color: var(--cavais-gray-100);
            }
            
            .c-table tbody tr:hover {
                background-color: var(--cavais-gray-700);
            }
        }
    `;
    
    // 반응형 CSS 주입
    const style = document.createElement('style');
    style.textContent = responsiveCSS;
    document.head.appendChild(style);
    
})(window, document);
